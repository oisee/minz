// Test that @lua blocks execute only once

@lua[[[
    print("=== Lua block 1 executed ===")
    global_counter = (global_counter or 0) + 1
    print("Global counter: " .. global_counter)
    
    -- Define a function
    function greet(name)
        return "Hello, " .. name .. "!"
    end
]]]

@lua[[[
    print("=== Lua block 2 executed ===")
    global_counter = global_counter + 1
    print("Global counter: " .. global_counter)
    
    -- Use the function from block 1
    local msg = greet("MinZ")
    print(msg)
]]]

fun main() -> u8 {
    @print("Main function running")
    @print("Lua blocks should have executed exactly once each")
    return 0;
}