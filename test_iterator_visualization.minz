// Visualization test for iterator transformation
// This file shows the transformation stages

fun main() -> void {
    let numbers: [u8; 5] = [10, 20, 30, 40, 50];
    
    // Simple forEach - demonstrates basic loop generation
    @print("=== Simple forEach ===");
    numbers.forEach(print_u8);
    
    // Chained operations - demonstrates fusion
    @print("\n=== Chained map + forEach ===");
    numbers.map(double).forEach(print_u8);
    
    // With iter() start - same result
    @print("\n=== With explicit iter() ===");
    numbers.iter().forEach(print_u8);
}

fun double(x: u8) -> u8 {
    return x * 2;
}

fun print_u8(x: u8) -> void {
    // Built-in function for printing u8 values
    @asm {
        LD A, x
        CALL $BB5A  ; ZX Spectrum ROM print routine
    }
}